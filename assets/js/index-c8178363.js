import{d as le,q as w,M,c as $,b as e,w as a,r as s,o as B,a as n,J as ne,y as se,K as re,h as c,t as u,F as j,n as de,H as q,E as S,_ as ue}from"./index-09569aab.js";const ie={class:"income-container"},ce={class:"card-header"},pe={class:"left"},me={class:"summary-cards"},_e={class:"number"},ve={class:"number"},fe={class:"number"},ge={class:"number up"},ye={class:"table-container"},he={class:de({"amount-up":!0})},ke={class:"operation-buttons"},be=["onClick"],we=["onClick"],xe=["onClick"],Ce=["onClick"],Ve=["onClick"],Se=["onClick"],Te=["onClick"],Re={class:"pagination-container"},ze={class:"amount-up"},Ue={class:"dialog-footer"},$e=le({__name:"index",setup(Be){const r=w({page:1,pageSize:10,keyword:"",type:"",dateRange:[]}),p=w([{id:1,code:"SR202503200001",type:"order",source:"山东临工工程机械有限公司",amount:586e3,createTime:"2025-02-20 09:30:00",remark:"工业机器人系统采购",status:"pending"},{id:2,code:"SR202503200002",type:"order",source:"青岛海尔生物医疗股份有限公司",amount:468e3,createTime:"2025-02-20 10:15:00",remark:"医疗机器人定制开发",status:"approved"},{id:3,code:"SR202503200003",type:"order",source:"山东新华医疗器械股份有限公司",amount:385e3,createTime:"2025-02-20 11:20:00",remark:"手术辅助机器人系统",status:"pending"},{id:4,code:"SR202503200004",type:"other",source:"技术服务收入",amount:156e3,createTime:"2025-02-20 13:45:00",remark:"系统维护服务费",status:"completed"},{id:5,code:"SR202503200005",type:"order",source:"浪潮电子信息产业股份有限公司",amount:658e3,createTime:"2025-02-20 14:30:00",remark:"智能制造系统集成",status:"pending"},{id:6,code:"SR202503200006",type:"order",source:"中通客车控股股份有限公司",amount:528e3,createTime:"2025-02-20 15:10:00",remark:"自动化生产线升级"},{id:7,code:"SR202503200007",type:"other",source:"配件销售收入",amount:168e3,createTime:"2025-02-20 15:45:00",remark:"机器人核心部件销售"},{id:8,code:"SR202503200008",type:"order",source:"山东魏桥创业集团有限公司",amount:785e3,createTime:"2025-02-20 16:00:00",remark:"智能仓储系统项目"},{id:9,code:"SR202503200009",type:"order",source:"山东晨鸣纸业集团股份有限公司",amount:496e3,createTime:"2025-02-20 16:30:00",remark:"自动化包装系统"},{id:10,code:"SR202503200010",type:"other",source:"培训服务收入",amount:128e3,createTime:"2025-02-20 17:00:00",remark:"操作技术培训服务"}]),E=w(100),T={currentMonth:4358e3,lastMonth:3685e3,currentYear:12568e3,yearGrowth:18.6},K=l=>({order:"订单收入",other:"其他收入"})[l]||"未知",V=()=>{r.value.page=1;const{keyword:l,type:t,dateRange:_}=r.value,i=p.value.filter(g=>{const y=!l||g.code.includes(l)||g.source.includes(l),h=!t||g.type===t,x=!_||_.length!==2||new Date(g.createTime)>=new Date(_[0])&&new Date(g.createTime)<=new Date(_[1]);return y&&h&&x});E.value=i.length;const f=(r.value.page-1)*r.value.pageSize,z=f+r.value.pageSize;p.value=i.slice(f,z)},v=M({form:!1,view:!1}),R=w("add"),N=w({}),d=M({type:"",source:"",amount:0,remark:""}),A=M({type:[{required:!0,message:"请选择收入类型",trigger:"change"}],source:[{required:!0,message:"请输入收入来源",trigger:"blur"}],amount:[{required:!0,message:"请输入收入金额",trigger:"blur"}]}),D=w(),G=()=>{R.value="add",Object.assign(d,{type:"",source:"",amount:0,remark:""}),v.form=!0},L=l=>{R.value="edit",Object.assign(d,{type:l.type,source:l.source,amount:l.amount,remark:l.remark}),N.value=l,v.form=!0},F=l=>{m.value=l,v.view=!0},O=l=>{q.confirm("确定要审核通过该收入记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l.status="approved",S.success("审核成功")}).catch(()=>{})},Y=l=>{q.confirm("确定要确认收款吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l.status="completed",S.success("确认收款成功")}).catch(()=>{})},H=l=>{q.confirm("确定要删除该收入记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=p.value.findIndex(_=>_.id===l.id);t>-1&&(p.value.splice(t,1),S.success("删除成功"))}).catch(()=>{})},J=async()=>{D.value&&await D.value.validate(l=>{if(l){const _=new Date().toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-");if(R.value==="add"){const i=`SR${_.replace(/[-: ]/g,"").slice(0,12)}${String(p.value.length+1).padStart(4,"0")}`;p.value.unshift({id:p.value.length+1,code:i,...d,createTime:_,status:"pending"}),S.success("添加成功")}else{const i=p.value.findIndex(f=>f.id===N.value.id);i>-1&&(p.value[i]={...p.value[i],...d,status:"pending"},S.success("修改成功"))}v.form=!1}})},P=l=>{r.value.pageSize=l,V()},Q=l=>{r.value.page=l,V()},m=w({});return V(),(l,t)=>{const _=s("el-icon"),i=s("el-input"),f=s("el-option"),z=s("el-select"),g=s("el-date-picker"),y=s("el-button"),h=s("el-card"),x=s("el-col"),W=s("el-row"),k=s("el-table-column"),X=s("el-table"),Z=s("el-pagination"),U=s("el-form-item"),ee=s("el-input-number"),te=s("el-form"),I=s("el-dialog"),b=s("el-descriptions-item"),ae=s("el-tag"),oe=s("el-descriptions");return B(),$("div",ie,[e(h,null,{header:a(()=>[n("div",ce,[n("div",pe,[e(i,{modelValue:r.value.keyword,"onUpdate:modelValue":t[0]||(t[0]=o=>r.value.keyword=o),placeholder:"请输入收入单号/来源",style:{width:"300px"},clearable:"",onKeyup:ne(V,["enter"])},{prefix:a(()=>[e(_,null,{default:a(()=>[e(se(re))]),_:1})]),_:1},8,["modelValue"]),e(z,{modelValue:r.value.type,"onUpdate:modelValue":t[1]||(t[1]=o=>r.value.type=o),placeholder:"收入类型",clearable:"",style:{width:"120px"}},{default:a(()=>[e(f,{label:"订单收入",value:"order"}),e(f,{label:"其他收入",value:"other"})]),_:1},8,["modelValue"]),e(g,{modelValue:r.value.dateRange,"onUpdate:modelValue":t[2]||(t[2]=o=>r.value.dateRange=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"240px"}},null,8,["modelValue"]),e(y,{type:"primary",onClick:V},{default:a(()=>t[13]||(t[13]=[c("搜索")])),_:1})]),e(y,{type:"primary",onClick:G},{default:a(()=>t[14]||(t[14]=[c("新增收入")])),_:1})])]),default:a(()=>[n("div",me,[e(W,{gutter:20},{default:a(()=>[e(x,{span:6},{default:a(()=>[e(h,{shadow:"hover",class:"data-card"},{default:a(()=>[t[15]||(t[15]=n("h3",null,"本月收入",-1)),n("div",_e,"¥"+u(T.currentMonth.toFixed(2)),1)]),_:1})]),_:1}),e(x,{span:6},{default:a(()=>[e(h,{shadow:"hover",class:"data-card"},{default:a(()=>[t[16]||(t[16]=n("h3",null,"上月收入",-1)),n("div",ve,"¥"+u(T.lastMonth.toFixed(2)),1)]),_:1})]),_:1}),e(x,{span:6},{default:a(()=>[e(h,{shadow:"hover",class:"data-card"},{default:a(()=>[t[17]||(t[17]=n("h3",null,"本年收入",-1)),n("div",fe,"¥"+u(T.currentYear.toFixed(2)),1)]),_:1})]),_:1}),e(x,{span:6},{default:a(()=>[e(h,{shadow:"hover",class:"data-card"},{default:a(()=>[t[18]||(t[18]=n("h3",null,"同比增长",-1)),n("div",ge,u(T.yearGrowth.toFixed(1))+"%",1)]),_:1})]),_:1})]),_:1})]),n("div",ye,[e(X,{data:p.value,border:"",style:{width:"100%"},height:"100%"},{default:a(()=>[e(k,{prop:"code",label:"收入单号",width:"180"}),e(k,{prop:"type",label:"收入类型",width:"120"},{default:a(({row:o})=>[c(u(K(o.type)),1)]),_:1}),e(k,{prop:"source",label:"收入来源"}),e(k,{prop:"amount",label:"收入金额",width:"120"},{default:a(({row:o})=>[n("span",he,"¥"+u(o.amount.toFixed(2)),1)]),_:1}),e(k,{prop:"createTime",label:"创建时间",width:"180"}),e(k,{prop:"remark",label:"备注","show-overflow-tooltip":""}),e(k,{label:"操作",width:"180",fixed:"right"},{default:a(({row:o})=>[n("div",ke,[o.status==="pending"?(B(),$(j,{key:0},[n("a",{onClick:C=>L(o)},"编辑",8,be),n("a",{onClick:C=>O(o)},"审核",8,we),n("a",{class:"danger",onClick:C=>H(o)},"删除",8,xe),n("a",{onClick:C=>F(o)},"查看",8,Ce)],64)):o.status==="approved"?(B(),$(j,{key:1},[n("a",{class:"success",onClick:C=>Y(o)},"确认收款",8,Ve),n("a",{onClick:C=>F(o)},"查看",8,Se)],64)):(B(),$("a",{key:2,onClick:C=>F(o)},"查看",8,Te))])]),_:1})]),_:1},8,["data"])]),n("div",Re,[e(Z,{"current-page":r.value.page,"onUpdate:currentPage":t[3]||(t[3]=o=>r.value.page=o),"page-size":r.value.pageSize,"onUpdate:pageSize":t[4]||(t[4]=o=>r.value.pageSize=o),total:E.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",onSizeChange:P,onCurrentChange:Q},null,8,["current-page","page-size","total"])])]),_:1}),e(I,{modelValue:v.form,"onUpdate:modelValue":t[10]||(t[10]=o=>v.form=o),title:R.value==="add"?"新增收入":"编辑收入",width:"600px"},{footer:a(()=>[e(y,{onClick:t[9]||(t[9]=o=>v.form=!1)},{default:a(()=>t[19]||(t[19]=[c("取消")])),_:1}),e(y,{type:"primary",onClick:J},{default:a(()=>t[20]||(t[20]=[c("确定")])),_:1})]),default:a(()=>[e(te,{ref_key:"formRef",ref:D,model:d,rules:A,"label-width":"100px"},{default:a(()=>[e(U,{label:"收入类型",prop:"type"},{default:a(()=>[e(z,{modelValue:d.type,"onUpdate:modelValue":t[5]||(t[5]=o=>d.type=o),placeholder:"请选择收入类型",style:{width:"100%"}},{default:a(()=>[e(f,{label:"订单收入",value:"order"}),e(f,{label:"其他收入",value:"other"})]),_:1},8,["modelValue"])]),_:1}),e(U,{label:"收入来源",prop:"source"},{default:a(()=>[e(i,{modelValue:d.source,"onUpdate:modelValue":t[6]||(t[6]=o=>d.source=o),placeholder:"请输入收入来源"},null,8,["modelValue"])]),_:1}),e(U,{label:"收入金额",prop:"amount"},{default:a(()=>[e(ee,{modelValue:d.amount,"onUpdate:modelValue":t[7]||(t[7]=o=>d.amount=o),precision:2,step:1e3,min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(U,{label:"备注",prop:"remark"},{default:a(()=>[e(i,{modelValue:d.remark,"onUpdate:modelValue":t[8]||(t[8]=o=>d.remark=o),type:"textarea",rows:3,placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),e(I,{modelValue:v.view,"onUpdate:modelValue":t[12]||(t[12]=o=>v.view=o),title:"收入详情",width:"600px"},{footer:a(()=>[n("span",Ue,[e(y,{onClick:t[11]||(t[11]=o=>v.view=!1)},{default:a(()=>t[21]||(t[21]=[c("关闭")])),_:1})])]),default:a(()=>[e(oe,{column:2,border:""},{default:a(()=>[e(b,{label:"收入单号"},{default:a(()=>[c(u(m.value.code),1)]),_:1}),e(b,{label:"收入类型"},{default:a(()=>[c(u(K(m.value.type)),1)]),_:1}),e(b,{label:"收入来源"},{default:a(()=>[c(u(m.value.source),1)]),_:1}),e(b,{label:"收入金额"},{default:a(()=>{var o;return[n("span",ze,"¥"+u((o=m.value.amount)==null?void 0:o.toFixed(2)),1)]}),_:1}),e(b,{label:"创建时间"},{default:a(()=>[c(u(m.value.createTime),1)]),_:1}),e(b,{label:"状态"},{default:a(()=>[e(ae,{type:m.value.status==="pending"?"warning":m.value.status==="approved"?"primary":"success"},{default:a(()=>[c(u(m.value.status==="pending"?"待处理":m.value.status==="approved"?"已审核":"已完成"),1)]),_:1},8,["type"])]),_:1}),e(b,{label:"备注",span:2},{default:a(()=>[c(u(m.value.remark),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});const Fe=ue($e,[["__scopeId","data-v-5ac43380"]]);export{Fe as default};
