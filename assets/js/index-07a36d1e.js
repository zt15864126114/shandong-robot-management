import{d as ce,q as g,M,c as b,b as e,w as t,r as o,o as B,a as d,J as me,y as _e,K as fe,h as s,t as m,F as N,G as k,E as y,H as z,_ as ge}from"./index-09569aab.js";const ve={class:"reimbursement-container"},ye={class:"card-header"},he={class:"left"},be={class:"table-container"},Be={class:"amount"},we={class:"operation-buttons"},xe=["onClick"],Ve=["onClick"],ke=["onClick"],ze=["onClick"],Te=["onClick"],Ce=["onClick"],je={class:"pagination-container"},Me={key:0,class:"attachments-container"},Se=["onClick"],Xe=ce({__name:"index",setup(Ue){const i=g({page:1,pageSize:10,keyword:"",type:"",status:"",dateRange:[]}),w=g([{id:1,code:"BX20250320001",type:"travel",applicant:"刘明阳",department:"销售部",amount:2860,status:"pending",createTime:"2025-03-20 09:30:00",description:"青岛客户拜访差旅费",attachments:[{name:"机票.pdf",size:"2.5MB"},{name:"住宿发票.jpg",size:"1.2MB"}]},{id:2,code:"BX20250320002",type:"entertainment",applicant:"王建国",department:"市场部",amount:1280,status:"approved",createTime:"2025-03-20 10:15:00",description:"客户接待餐费",attachments:[{name:"餐饮发票.jpg",size:"0.8MB"}]},{id:3,code:"BX20250320003",type:"office",applicant:"张志强",department:"技术部",amount:560,status:"rejected",createTime:"2025-03-19 14:20:00",description:"办公用品采购",attachments:[{name:"办公用品发票.jpg",size:"0.5MB"}]},{id:4,code:"BX20250320004",type:"travel",applicant:"陈海波",department:"销售部",amount:3420,status:"paid",createTime:"2025-03-19 11:30:00",description:"北京展会差旅费",attachments:[{name:"机票.pdf",size:"2.8MB"},{name:"住宿发票.jpg",size:"1.5MB"},{name:"展会门票.pdf",size:"1.0MB"}]},{id:5,code:"BX20250320005",type:"entertainment",applicant:"李伟东",department:"市场部",amount:2560,status:"pending",createTime:"2025-03-18 16:45:00",description:"客户答谢晚宴",attachments:[{name:"餐饮发票.jpg",size:"1.2MB"}]},{id:6,code:"BX20250320006",type:"office",applicant:"赵明",department:"行政部",amount:890,status:"approved",createTime:"2025-03-18 09:20:00",description:"办公设备维修费",attachments:[{name:"维修发票.jpg",size:"0.6MB"}]},{id:7,code:"BX20250320007",type:"travel",applicant:"刘明阳",department:"销售部",amount:1890,status:"pending",createTime:"2025-03-17 15:30:00",description:"济南客户拜访差旅费",attachments:[{name:"高铁票.pdf",size:"1.8MB"},{name:"住宿发票.jpg",size:"0.9MB"}]},{id:8,code:"BX20250320008",type:"other",applicant:"王建国",department:"市场部",amount:680,status:"rejected",createTime:"2025-03-17 10:45:00",description:"快递费",attachments:[{name:"快递发票.jpg",size:"0.4MB"}]},{id:9,code:"BX20250320009",type:"entertainment",applicant:"张志强",department:"技术部",amount:1560,status:"approved",createTime:"2025-03-16 14:15:00",description:"团队建设活动",attachments:[{name:"活动发票.jpg",size:"1.1MB"}]},{id:10,code:"BX20250320010",type:"office",applicant:"陈海波",department:"销售部",amount:420,status:"paid",createTime:"2025-03-16 11:20:00",description:"办公用品采购",attachments:[{name:"办公用品发票.jpg",size:"0.7MB"}]},{id:11,code:"BX20250320011",type:"travel",applicant:"李伟东",department:"市场部",amount:3240,status:"pending",createTime:"2025-03-15 16:30:00",description:"上海展会差旅费",attachments:[{name:"机票.pdf",size:"2.2MB"},{name:"住宿发票.jpg",size:"1.3MB"},{name:"展会门票.pdf",size:"0.9MB"}]},{id:12,code:"BX20250320012",type:"entertainment",applicant:"赵明",department:"行政部",amount:980,status:"approved",createTime:"2025-03-15 09:45:00",description:"部门聚餐",attachments:[{name:"餐饮发票.jpg",size:"0.6MB"}]}]),O=g(100),f=M({form:!1,view:!1}),x=g("add"),S=g({}),p=g({}),u=M({type:"",amount:0,description:"",attachments:[]}),K=M({type:[{required:!0,message:"请选择报销类型",trigger:"change"}],amount:[{required:!0,message:"请输入金额",trigger:"blur"}],description:[{required:!0,message:"请输入报销说明",trigger:"blur"}]}),T=g(),I=g(!0),L=g(!0),X=l=>({travel:"差旅费",office:"办公用品",entertainment:"业务招待",other:"其他"})[l]||"未知",U=l=>({pending:"待审核",approved:"已通过",rejected:"已驳回",paid:"已支付"})[l]||"未知",$=l=>({pending:"warning",approved:"success",rejected:"danger",paid:"success"})[l]||"info",R=()=>{i.value.page=1,C()},C=()=>{console.log("加载报销列表:",i.value)},P=()=>{x.value="add",Object.assign(u,{type:"",amount:0,description:"",attachments:[]}),f.form=!0},G=l=>{x.value="edit",Object.assign(u,l),S.value=l,f.form=!0},H=l=>{p.value=l,f.view=!0},J=l=>{y.success("开始下载附件")},Q=l=>{z.confirm("确定要删除该报销记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{console.log("删除报销:",l),y.success("删除成功")}).catch(()=>{})},W=l=>{z.confirm("确定要通过该报销申请吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l.status="approved",y.success("已通过")}).catch(()=>{})},Y=l=>{z.confirm("确定要驳回该报销申请吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l.status="rejected",y.success("已驳回")}).catch(()=>{})},Z=l=>{z.confirm("确定要支付该报销款项吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l.status="paid",y.success("支付成功")}).catch(()=>{})},ee=()=>{C()},te=()=>{C()},ae=async()=>{T.value&&await T.value.validate(l=>{l&&(x.value==="add"?(w.value.unshift({id:w.value.length+1,code:`BX${new Date().toISOString().slice(0,10).replace(/-/g,"")}${String(w.value.length+1).padStart(3,"0")}`,applicant:"刘明阳",department:"销售部",status:"pending",createTime:new Date().toLocaleString(),...u}),y.success("添加成功")):(Object.assign(S.value,u),y.success("修改成功")),f.form=!1)})};return(l,n)=>{const ne=o("el-icon"),D=o("el-input"),r=o("el-option"),j=o("el-select"),le=o("el-date-picker"),h=o("el-button"),c=o("el-table-column"),q=o("el-tag"),E=o("el-table"),oe=o("el-pagination"),se=o("el-card"),V=o("el-form-item"),F=o("el-col"),ie=o("el-input-number"),de=o("el-row"),pe=o("el-upload"),re=o("el-form"),A=o("el-dialog"),v=o("el-descriptions-item"),ue=o("el-descriptions");return B(),b("div",ve,[e(se,null,{header:t(()=>[d("div",ye,[d("div",he,[e(D,{modelValue:i.value.keyword,"onUpdate:modelValue":n[0]||(n[0]=a=>i.value.keyword=a),placeholder:"请输入报销单号/申请人",style:{width:"300px"},clearable:"",onKeyup:me(R,["enter"])},{prefix:t(()=>[e(ne,null,{default:t(()=>[e(_e(fe))]),_:1})]),_:1},8,["modelValue"]),e(j,{modelValue:i.value.type,"onUpdate:modelValue":n[1]||(n[1]=a=>i.value.type=a),placeholder:"报销类型",clearable:"",style:{width:"120px"}},{default:t(()=>[e(r,{label:"差旅费",value:"travel"}),e(r,{label:"办公用品",value:"office"}),e(r,{label:"业务招待",value:"entertainment"}),e(r,{label:"其他",value:"other"})]),_:1},8,["modelValue"]),e(j,{modelValue:i.value.status,"onUpdate:modelValue":n[2]||(n[2]=a=>i.value.status=a),placeholder:"状态",clearable:"",style:{width:"120px"}},{default:t(()=>[e(r,{label:"待审核",value:"pending"}),e(r,{label:"已通过",value:"approved"}),e(r,{label:"已驳回",value:"rejected"}),e(r,{label:"已支付",value:"paid"})]),_:1},8,["modelValue"]),e(le,{modelValue:i.value.dateRange,"onUpdate:modelValue":n[3]||(n[3]=a=>i.value.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"240px"}},null,8,["modelValue"]),e(h,{type:"primary",onClick:R},{default:t(()=>n[12]||(n[12]=[s("搜索")])),_:1})]),e(h,{type:"primary",onClick:P},{default:t(()=>n[13]||(n[13]=[s("新增报销")])),_:1})])]),default:t(()=>[d("div",be,[e(E,{data:w.value,border:"",style:{width:"100%"},height:"100%"},{default:t(()=>[e(c,{prop:"code",label:"报销单号",width:"180"}),e(c,{prop:"type",label:"报销类型",width:"120"},{default:t(({row:a})=>[s(m(X(a.type)),1)]),_:1}),e(c,{prop:"applicant",label:"申请人",width:"120"}),e(c,{prop:"department",label:"部门",width:"120"}),e(c,{prop:"amount",label:"金额",width:"120"},{default:t(({row:a})=>[d("span",Be,"¥"+m(a.amount.toFixed(2)),1)]),_:1}),e(c,{prop:"status",label:"状态",width:"100"},{default:t(({row:a})=>[e(q,{type:$(a.status)},{default:t(()=>[s(m(U(a.status)),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"createTime",label:"申请时间",width:"180"}),e(c,{label:"操作",width:"200",fixed:"right"},{default:t(({row:a})=>[d("div",we,[d("a",{onClick:_=>H(a)},"查看",8,xe),a.status==="pending"?(B(),b(N,{key:0},[d("a",{onClick:_=>G(a)},"编辑",8,Ve),d("a",{class:"danger",onClick:_=>Q(a)},"删除",8,ke)],64)):k("",!0),a.status==="pending"&&I.value?(B(),b(N,{key:1},[d("a",{class:"success",onClick:_=>W(a)},"通过",8,ze),d("a",{class:"danger",onClick:_=>Y(a)},"驳回",8,Te)],64)):k("",!0),a.status==="approved"&&L.value?(B(),b("a",{key:2,class:"success",onClick:_=>Z(a)},"支付",8,Ce)):k("",!0)])]),_:1})]),_:1},8,["data"])]),d("div",je,[e(oe,{"current-page":i.value.page,"onUpdate:currentPage":n[4]||(n[4]=a=>i.value.page=a),"page-size":i.value.pageSize,"onUpdate:pageSize":n[5]||(n[5]=a=>i.value.pageSize=a),total:O.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",onSizeChange:ee,onCurrentChange:te},null,8,["current-page","page-size","total"])])]),_:1}),e(A,{modelValue:f.form,"onUpdate:modelValue":n[10]||(n[10]=a=>f.form=a),title:x.value==="add"?"新增报销":"编辑报销",width:"700px"},{footer:t(()=>[e(h,{onClick:n[9]||(n[9]=a=>f.form=!1)},{default:t(()=>n[16]||(n[16]=[s("取消")])),_:1}),e(h,{type:"primary",onClick:ae},{default:t(()=>n[17]||(n[17]=[s("确定")])),_:1})]),default:t(()=>[e(re,{ref_key:"formRef",ref:T,model:u,rules:K,"label-width":"100px"},{default:t(()=>[e(de,{gutter:20},{default:t(()=>[e(F,{span:12},{default:t(()=>[e(V,{label:"报销类型",prop:"type"},{default:t(()=>[e(j,{modelValue:u.type,"onUpdate:modelValue":n[6]||(n[6]=a=>u.type=a),placeholder:"请选择报销类型",style:{width:"100%"}},{default:t(()=>[e(r,{label:"差旅费",value:"travel"}),e(r,{label:"办公用品",value:"office"}),e(r,{label:"业务招待",value:"entertainment"}),e(r,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(F,{span:12},{default:t(()=>[e(V,{label:"金额",prop:"amount"},{default:t(()=>[e(ie,{modelValue:u.amount,"onUpdate:modelValue":n[7]||(n[7]=a=>u.amount=a),precision:2,step:100,min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(V,{label:"报销说明",prop:"description"},{default:t(()=>[e(D,{modelValue:u.description,"onUpdate:modelValue":n[8]||(n[8]=a=>u.description=a),type:"textarea",rows:3,placeholder:"请输入报销说明"},null,8,["modelValue"])]),_:1}),e(V,{label:"附件",prop:"attachments"},{default:t(()=>[e(pe,{class:"upload-demo",action:"#","auto-upload":!1,limit:5,multiple:""},{trigger:t(()=>[e(h,{type:"primary"},{default:t(()=>n[14]||(n[14]=[s("选择文件")])),_:1})]),tip:t(()=>n[15]||(n[15]=[d("div",{class:"el-upload__tip"}," 支持jpg/png/pdf格式，单个文件不超过10MB ",-1)])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),e(A,{modelValue:f.view,"onUpdate:modelValue":n[11]||(n[11]=a=>f.view=a),title:"报销详情",width:"800px"},{default:t(()=>{var a;return[e(ue,{column:2,border:""},{default:t(()=>[e(v,{label:"报销单号"},{default:t(()=>[s(m(p.value.code),1)]),_:1}),e(v,{label:"报销类型"},{default:t(()=>[s(m(X(p.value.type)),1)]),_:1}),e(v,{label:"申请人"},{default:t(()=>[s(m(p.value.applicant),1)]),_:1}),e(v,{label:"部门"},{default:t(()=>[s(m(p.value.department),1)]),_:1}),e(v,{label:"金额"},{default:t(()=>{var _;return[s("¥"+m((_=p.value.amount)==null?void 0:_.toFixed(2)),1)]}),_:1}),e(v,{label:"状态"},{default:t(()=>[e(q,{type:$(p.value.status)},{default:t(()=>[s(m(U(p.value.status)),1)]),_:1},8,["type"])]),_:1}),e(v,{label:"申请时间"},{default:t(()=>[s(m(p.value.createTime),1)]),_:1}),e(v,{label:"报销说明"},{default:t(()=>[s(m(p.value.description),1)]),_:1})]),_:1}),(a=p.value.attachments)!=null&&a.length?(B(),b("div",Me,[n[18]||(n[18]=d("h4",null,"附件列表",-1)),e(E,{data:p.value.attachments,border:"",style:{width:"100%"}},{default:t(()=>[e(c,{prop:"name",label:"文件名"}),e(c,{prop:"size",label:"大小",width:"120"}),e(c,{label:"操作",width:"120"},{default:t(({row:_})=>[d("a",{onClick:$e=>J(_)},"下载",8,Se)]),_:1})]),_:1},8,["data"])])):k("",!0)]}),_:1},8,["modelValue"])])}}});const De=ge(Xe,[["__scopeId","data-v-f30b49ea"]]);export{De as default};
